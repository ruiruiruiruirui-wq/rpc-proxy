    location ~ ^/node/(btc--0|tbtc--0|doge--0|ltc--0|bch--0|evm--10143|neo--3|evm--80094)(?:/(.*))?$ {
        access_log /etc/nginx/logs/node-access.log rpc-proxy;
        error_log /etc/nginx/logs/node-error.log error;

        set $api $1;
        set $rest $2;

        # 根据 color 变量设置后端域名
        if ($api = "btc--0") {
            set $backend "http://192.168.1.3:8030/";
            set_by_lua_block $basic_auth_str {
                local v = os.getenv("BTC_NODE_BASIC_AUTH") or ""
                if v ~= "" and not string.find(string.lower(v), "^basic ") then
                    return "Basic " .. v
                end
                return v
            }
            set $myhost "192.168.1.3:8030";
        }

        if ($api = "tbtc--0") {
            set $backend "http://13.214.174.120:18030/";
            set_by_lua_block $basic_auth_str {
                local v = os.getenv("TBTC_NODE_BASIC_AUTH") or ""
                if v ~= "" and not string.find(string.lower(v), "^basic ") then
                    return "Basic " .. v
                end
                return v
            }
            set $myhost "13.214.174.120:18030";
        }

        if ($api = "doge--0") {
            set $backend "https://doge.nownodes.io/";
            set_by_lua_block $nownodes_key {
                return os.getenv("DOGE_NOWNODES_API_KEY") or ""
            }
            set $backend "$backend$nownodes_key/";
            set $myhost "doge.nownodes.io";
        }

        if ($api = "ltc--0") {
            set $backend "https://ltc.nownodes.io/";
            set_by_lua_block $ltc_key {
                return os.getenv("LTC_NOWNODES_API_KEY") or ""
            }
            set $backend "$backend$ltc_key/";
            set $myhost "ltc.nownodes.io";
        }

        if ($api = "bch--0") {
            set $backend "https://bch.nownodes.io/";
            set_by_lua_block $bch_key {
                return os.getenv("BCH_NOWNODES_API_KEY") or ""
            }
            set $backend "$backend$bch_key/";
            set $myhost "bch.nownodes.io";
        }

        if ($api = "evm--10143") {
            set $backend "https://testnet-rpc.monad.xyz/";
            set $myhost "testnet-rpc.monad.xyz";
        }

        if ($api = "neo--3") {
            set $backend "http://seed1.neo.org:10332/";
            set $myhost "seed1.neo.org";
        }

        if ($api = "evm--80094") {
            set $backend "https://rpc.berachain.com";
            set $myhost "rpc.berachain.com";
        }

        # 构建正确的后端URL - 直接使用backend，如果有rest则追加
        if ($rest) {
            set $backend_url "$backend$rest";
        }
        if ($rest = "") {
            set $backend_url "$backend";
        }

        proxy_pass $backend_url;

        proxy_set_header Host $myhost;
        proxy_set_header Accept-Encoding "identity";
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Authorization $basic_auth_str;
        proxy_set_header Content-Type $content_type;
        proxy_ssl_server_name on;
        proxy_redirect off;
        proxy_buffering off;
        proxy_request_buffering off;
    }


